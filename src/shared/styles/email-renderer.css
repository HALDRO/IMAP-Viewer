/**
 * @file Email Renderer Enhanced Styles
 * @description Extended styles for email rendering with fixes for various email clients.
 * Handles Gmail, Outlook, Apple Mail quirks and ensures consistent display.
 */

/* ========================================
   EMAIL RENDERER BASE
   ======================================== */
.email-renderer {
  width: 100%;
  max-width: 100%;
  overflow-x: hidden;
  word-wrap: break-word;
  overflow-wrap: break-word;
}

/* ========================================
   EMAIL CLIENT SPECIFIC FIXES
   ======================================== */

/* Gmail: Fix for collapsed margins */
.email-renderer > *:first-child {
  margin-top: 0 !important;
}

.email-renderer > *:last-child {
  margin-bottom: 0 !important;
}

/* Outlook: Table normalization */
.email-table {
  border-collapse: collapse !important;
  mso-table-lspace: 0 !important;
  mso-table-rspace: 0 !important;
  border-spacing: 0 !important;
}

.email-table td {
  mso-line-height-rule: exactly;
}

/* Apple Mail: Prevent auto-detection styling */
.email-renderer a[href^="tel"],
.email-renderer a[href^="sms"] {
  color: inherit;
  text-decoration: none;
}

/* ========================================
   RESPONSIVE TABLES
   ======================================== */
@media (max-width: 768px) {
  .email-table {
    width: 100% !important;
    min-width: auto !important;
  }

  .email-table td,
  .email-table th {
    display: block;
    width: 100% !important;
    box-sizing: border-box;
  }

  /* Stack table cells vertically on mobile */
  .email-table tr {
    display: block;
    margin-bottom: var(--spacing-2);
  }
}

/* ========================================
   IMAGES NORMALIZATION
   ======================================== */
.email-img {
  display: block;
  max-width: 100% !important;
  height: auto !important;
  border: 0;
  outline: none;
  text-decoration: none;
  -ms-interpolation-mode: bicubic;
}

/* Retina images support */
@media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi) {
  .email-img {
    -webkit-font-smoothing: antialiased;
  }
}

/* ========================================
   EMBEDDED STYLES OVERRIDE
   ======================================== */

/* Force our color scheme on email content */
.email-renderer [style*="color: #000"],
.email-renderer [style*="color: black"],
.email-renderer [style*="color:rgb(0,0,0)"] {
  color: rgb(var(--color-foreground)) !important;
}

.email-renderer [style*="background: white"],
.email-renderer [style*="background: #fff"],
.email-renderer [style*="background-color: white"],
.email-renderer [style*="background-color: #fff"] {
  background: rgb(var(--color-card) / 0.3) !important;
}

/* ========================================
   MARKETING EMAIL SUPPORT
   ======================================== */

/* Gmail promotions tab fix */
.email-renderer .gmail-blend-screen,
.email-renderer .gmail-blend-difference {
  background: transparent !important;
  mix-blend-mode: normal !important;
}

/* Outlook.com dark mode fix */
[data-ogsc] .email-renderer {
  background: transparent !important;
}

/* ========================================
   STRUCTURED CONTENT
   ======================================== */

/* Order confirmations, receipts */
.email-renderer .receipt-table,
.email-renderer .order-summary {
  background: rgb(var(--color-card) / 0.5);
  border: 1px solid rgb(var(--color-border));
  border-radius: var(--radius-md);
  padding: var(--spacing-4);
  margin: var(--spacing-4) 0;
}

.email-renderer .price-total {
  font-weight: var(--font-weight-bold);
  font-size: var(--font-size-lg);
  color: rgb(var(--color-primary));
}

/* Event invitations, calendar */
.email-renderer .event-details {
  background: rgb(var(--color-card) / 0.5);
  border-left: 4px solid rgb(var(--color-primary));
  padding: var(--spacing-4);
  margin: var(--spacing-4) 0;
}

/* ========================================
   DARK MODE SUPPORT
   ======================================== */
@media (prefers-color-scheme: dark) {
  .email-renderer img {
    opacity: 0.9;
  }

  .email-renderer [style*="background: white"],
  .email-renderer [style*="background-color: white"] {
    background: rgb(var(--color-card)) !important;
  }
}

/* ========================================
   PRINT STYLES
   ======================================== */
@media print {
  .email-renderer {
    background: white !important;
    color: black !important;
  }

  .email-renderer a {
    color: black !important;
    text-decoration: underline !important;
  }

  .email-renderer img {
    max-width: 100%;
    page-break-inside: avoid;
  }
}

